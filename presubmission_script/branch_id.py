#    branch_id.py: a module used by presubmission.py to generate summary
#    statistics for submission to the GREAT3 Challenge
#
# Copyright (c) 2014, the GREAT3 executive committee (http://www.great3challenge.info/?q=contacts)
# All rights reserved.
#
# Redistribution and use in source and binary forms, with or without modification, are permitted
# provided that the following conditions are met:
#
# 1. Redistributions of source code must retain the above copyright notice, this list of conditions
# and the following disclaimer.
#
# 2. Redistributions in binary form must reproduce the above copyright notice, this list of
# conditions and the following disclaimer in the documentation and/or other materials provided with
# the distribution.
#
# 3. Neither the name of the copyright holder nor the names of its contributors may be used to
# endorse or promote products derived from this software without specific prior written permission.
#
# THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR
# IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND
# FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR
# CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
# DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
# DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER
# IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
# OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

experiments = ['control', 'real_galaxy', 'variable_psf', 'multiepoch', 'full']
observation_types = ['ground', 'space']
shear_types = ['constant', 'variable']

# Generate a regular expression that will match any branch name, such as
# control-ground-constant or variable_psf/space/variable, as well as a list of branch names
# delineated with hyphens.
branch_regex_names = []
branch_names = []
for exp in experiments:
    for otype in observation_types:
        for stype in shear_types:
            branch_regex_names.append(exp+'.'+otype+'.'+stype)
            branch_names.append(exp+'-'+otype+'-'+stype)
import re
branch_regex=re.compile('|'.join(branch_regex_names))

def formatted_branch_name(branch):
    """
    Takes a branch name which may be delineated by eg '/' (if it's a subdirectory structure),
    and turns it into a hyphen-delinated version of the same string.
    """
    for exp in experiments:
        if exp in branch:
            for otype in observation_types:
                if otype in branch:
                    for stype in shear_types:
                        if stype in branch:
                            return exp+'-'+otype+'-'+stype
    raise RuntimeError('Branch %s does not appear to be a valid branch name--please pass one of '
                         '[%s] with the command-line option -b.'%(branch, ', '.join(branch_names)))

# Subfield offsets for the variable branches.  Note that this section of code will change with 
# each new simulation release!

x_offset = {'control-ground-variable': 
                    [0, 3, 4, 3, 6, 3, 6, 1, 5, 0, 6, 0, 2, 5, 3, 2, 3, 5, 1, 1, 0, 1, 6, 2, 1, 
                     3, 5, 6, 2, 0, 5, 5, 3, 5, 2, 4, 4, 4, 3, 4, 0, 5, 5, 0, 6, 5, 1, 1, 4, 1, 
                     3, 1, 5, 3, 6, 6, 4, 4, 2, 2, 0, 3, 4, 1, 0, 0, 5, 3, 1, 2, 5, 2, 2, 3, 4, 
                     0, 6, 5, 3, 2, 0, 1, 3, 6, 3, 3, 0, 5, 2, 5, 4, 1, 0, 6, 3, 4, 1, 2, 5, 4, 
                     0, 3, 1, 5, 6, 4, 3, 5, 3, 5, 2, 0, 2, 3, 4, 5, 4, 2, 2, 0, 0, 0, 6, 3, 5, 
                     5, 1, 1, 1, 4, 0, 2, 5, 4, 2, 1, 2, 0, 2, 0, 0, 1, 1, 0, 3, 2, 3, 2, 2, 4, 
                     6, 6, 0, 1, 4, 3, 3, 2, 5, 5, 0, 1, 4, 4, 1, 4, 2, 5, 0, 3, 3, 4, 0, 4, 1, 
                     2, 2, 1, 6, 3, 0, 2, 2, 4, 3, 5, 5, 2, 1, 3, 0, 1, 4, 1, 2, 6, 6, 5, 3, 4],
            'control-space-variable':
                    [0, 1, 4, 4, 5, 6, 5, 3, 0, 5, 3, 5, 1, 6, 0, 1, 2, 4, 6, 0, 0, 6, 4, 4, 3, 
                     6, 4, 0, 5, 3, 5, 1, 3, 4, 2, 1, 2, 5, 0, 1, 0, 6, 5, 0, 0, 5, 0, 0, 2, 1, 
                     1, 4, 4, 6, 3, 1, 5, 2, 2, 6, 0, 3, 2, 5, 0, 3, 1, 3, 6, 2, 6, 6, 2, 1, 3, 
                     4, 6, 1, 0, 0, 0, 6, 3, 1, 2, 0, 6, 2, 6, 4, 3, 2, 5, 5, 2, 0, 3, 5, 0, 0, 
                     0, 1, 2, 6, 1, 2, 5, 2, 4, 5, 5, 4, 6, 0, 1, 4, 6, 0, 0, 5, 0, 4, 5, 4, 2, 
                     4, 0, 0, 3, 5, 5, 2, 2, 6, 4, 6, 2, 3, 0, 1, 0, 5, 6, 0, 2, 1, 1, 4, 3, 4, 
                     1, 5, 3, 1, 2, 5, 3, 6, 4, 4, 0, 6, 2, 1, 5, 0, 5, 3, 0, 2, 6, 3, 4, 1, 2, 
                     4, 1, 0, 6, 5, 0, 4, 3, 5, 0, 1, 3, 4, 1, 3, 6, 5, 4, 2, 5, 0, 3, 3, 6, 6],
            'multiepoch-ground-variable':
                    [0, 3, 4, 2, 1, 5, 6, 2, 2, 1, 6, 5, 0, 5, 3, 2, 2, 3, 1, 4, 0, 4, 3, 6, 6,
                     3, 3, 1, 2, 1, 4, 5, 5, 0, 5, 3, 5, 0, 3, 3, 0, 4, 3, 4, 1, 0, 6, 2, 1, 3,
                     6, 5, 1, 4, 0, 5, 6, 5, 5, 5, 0, 3, 0, 0, 2, 4, 5, 2, 2, 6, 6, 5, 6, 6, 5,
                     3, 3, 1, 4, 1, 0, 6, 2, 5, 4, 3, 4, 4, 2, 0, 5, 2, 1, 1, 0, 1, 0, 2, 4, 1,
                     0, 5, 4, 6, 0, 5, 4, 2, 3, 3, 4, 4, 2, 4, 4, 0, 1, 5, 0, 3, 0, 6, 5, 3, 0,
                     6, 4, 2, 5, 3, 1, 4, 3, 0, 1, 0, 3, 1, 5, 6, 0, 0, 0, 5, 6, 4, 3, 2, 5, 4,
                     2, 2, 6, 0, 2, 6, 1, 6, 1, 4, 0, 0, 2, 1, 4, 4, 6, 0, 1, 2, 5, 3, 6, 1, 2,
                     0, 2, 5, 3, 3, 0, 0, 2, 1, 4, 6, 6, 4, 0, 5, 0, 1, 5, 3, 2, 3, 2, 5, 4, 4],
            'multiepoch-space-variable':
                    [0, 4, 0, 4, 1, 2, 1, 6, 0, 4, 3, 6, 5, 6, 5, 1, 5, 5, 1, 3, 0, 5, 2, 4, 5,
                     1, 6, 5, 2, 3, 2, 0, 6, 1, 2, 1, 0, 2, 6, 5, 0, 3, 4, 5, 5, 0, 4, 1, 5, 4,
                     1, 1, 6, 4, 5, 1, 6, 0, 3, 3, 0, 0, 0, 3, 6, 5, 4, 1, 1, 5, 6, 0, 0, 1, 3,
                     4, 3, 1, 2, 1, 0, 2, 4, 4, 6, 3, 3, 0, 5, 1, 1, 0, 3, 0, 1, 6, 2, 0, 4, 4,
                     0, 6, 0, 0, 2, 2, 3, 4, 1, 6, 2, 5, 3, 1, 2, 5, 1, 5, 6, 0, 0, 4, 5, 3, 4,
                     2, 6, 2, 0, 6, 1, 3, 5, 2, 3, 6, 5, 4, 3, 0, 0, 5, 4, 6, 4, 3, 0, 6, 5, 1,
                     4, 6, 3, 3, 4, 0, 5, 6, 2, 4, 0, 0, 4, 3, 2, 4, 2, 6, 5, 6, 6, 2, 5, 2, 5,
                     4, 0, 2, 4, 6, 0, 3, 2, 1, 1, 3, 4, 1, 2, 4, 5, 2, 5, 2, 0, 6, 6, 5, 4, 0],
             'variable_psf-ground-variable':
                    [0, 2, 5, 2, 2, 1, 6, 2, 2, 1, 0, 0, 5, 4, 4, 6, 4, 0, 2, 3, 0, 6, 1, 3, 0,
                     0, 1, 5, 1, 5, 1, 0, 2, 1, 4, 2, 6, 3, 3, 2, 0, 5, 0, 5, 0, 5, 2, 1, 6, 2,
                     6, 2, 2, 4, 5, 1, 1, 1, 4, 0, 0, 4, 4, 1, 5, 4, 6, 6, 6, 5, 1, 2, 6, 2, 5,
                     3, 0, 1, 3, 3, 0, 3, 4, 3, 6, 2, 4, 2, 5, 4, 5, 5, 0, 3, 5, 6, 0, 4, 2, 1,
                     0, 3, 4, 6, 6, 0, 1, 3, 5, 0, 5, 2, 1, 2, 3, 2, 4, 0, 4, 2, 0, 1, 2, 1, 4,
                     3, 3, 2, 5, 5, 0, 4, 5, 0, 6, 6, 5, 0, 5, 4, 0, 3, 0, 0, 6, 3, 5, 3, 3, 1,
                     4, 2, 6, 4, 3, 5, 0, 4, 1, 0, 0, 4, 2, 1, 1, 0, 5, 3, 3, 3, 0, 1, 4, 0, 3,
                     1, 4, 4, 6, 6, 0, 1, 4, 0, 3, 2, 3, 4, 4, 0, 6, 3, 6, 2, 2, 3, 1, 6, 0, 5],
            'variable_psf-space-variable':
                    [0, 2, 4, 3, 5, 4, 4, 4, 1, 0, 2, 3, 1, 4, 1, 1, 2, 4, 5, 3, 0, 0, 4, 5, 2,
                     4, 2, 3, 6, 2, 1, 5, 1, 4, 0, 3, 6, 6, 0, 0, 0, 4, 5, 0, 4, 5, 4, 6, 6, 4,
                     2, 0, 3, 1, 0, 2, 4, 0, 1, 3, 0, 1, 4, 0, 4, 1, 4, 3, 4, 6, 6, 3, 6, 5, 2,
                     4, 0, 2, 1, 2, 0, 0, 5, 0, 5, 2, 5, 0, 1, 4, 6, 1, 1, 3, 5, 1, 3, 0, 3, 6,
                     0, 4, 4, 1, 6, 4, 6, 4, 3, 2, 4, 3, 1, 6, 6, 4, 5, 2, 1, 3, 0, 6, 0, 1, 4,
                     6, 4, 5, 2, 3, 0, 0, 5, 4, 2, 5, 3, 1, 5, 5, 0, 4, 6, 4, 0, 6, 3, 5, 4, 5,
                     6, 1, 5, 0, 2, 0, 2, 5, 3, 5, 0, 4, 2, 3, 2, 3, 3, 2, 1, 0, 6, 3, 6, 6, 3,
                     0, 4, 5, 0, 4, 0, 1, 4, 5, 3, 2, 4, 2, 3, 3, 0, 4, 1, 6, 1, 5, 6, 0, 4, 2],
            'real_galaxy-ground-variable': 
                    [0, 6, 3, 5, 3, 4, 1, 5, 2, 4, 5, 5, 1, 3, 3, 6, 6, 1, 1, 1, 0, 3, 2, 4, 2, 
                     6, 2, 1, 1, 4, 5, 1, 6, 3, 3, 5, 0, 5, 5, 5, 0, 6, 0, 5, 3, 4, 0, 5, 5, 4, 
                     0, 1, 4, 1, 1, 2, 0, 5, 3, 1, 0, 1, 1, 0, 0, 4, 1, 3, 2, 0, 3, 2, 0, 4, 4, 
                     0, 5, 6, 5, 1, 0, 1, 5, 2, 6, 6, 0, 4, 0, 5, 5, 1, 5, 4, 1, 5, 0, 6, 6, 3, 
                     0, 3, 1, 5, 0, 0, 2, 6, 6, 1, 4, 6, 0, 3, 3, 5, 2, 3, 4, 0, 0, 6, 0, 3, 0, 
                     4, 1, 5, 2, 0, 5, 3, 0, 5, 5, 4, 4, 0, 6, 1, 0, 1, 0, 0, 3, 2, 2, 2, 0, 3, 
                     6, 5, 3, 0, 5, 5, 6, 6, 4, 1, 0, 0, 3, 6, 4, 3, 1, 5, 3, 4, 3, 1, 5, 6, 3, 
                     2, 5, 4, 6, 1, 0, 5, 3, 5, 3, 6, 2, 4, 0, 2, 4, 0, 0, 1, 2, 0, 0, 6, 5, 3],
            'real_galaxy-space-variable': 
                    [0, 3, 5, 5, 2, 5, 3, 0, 1, 1, 4, 6, 6, 1, 5, 3, 4, 5, 5, 2, 0, 6, 6, 0, 4, 
                     3, 5, 5, 5, 1, 4, 2, 1, 2, 1, 2, 3, 4, 0, 3, 0, 2, 4, 3, 2, 0, 1, 6, 5, 6, 
                     6, 1, 1, 6, 5, 4, 5, 4, 3, 2, 0, 0, 1, 3, 1, 4, 0, 6, 5, 4, 0, 1, 5, 3, 1, 
                     5, 2, 5, 2, 4, 0, 1, 2, 3, 4, 2, 0, 4, 6, 3, 3, 3, 5, 1, 1, 4, 4, 6, 2, 1, 
                     0, 6, 0, 2, 6, 1, 3, 4, 2, 4, 3, 3, 6, 1, 3, 6, 6, 0, 0, 5, 0, 0, 2, 6, 2, 
                     2, 5, 5, 0, 5, 4, 6, 4, 4, 2, 2, 6, 1, 3, 5, 0, 6, 1, 2, 6, 2, 1, 5, 6, 1, 
                     3, 1, 1, 4, 2, 3, 5, 0, 3, 0, 0, 1, 6, 2, 4, 3, 5, 2, 4, 1, 0, 4, 2, 3, 1, 
                     0, 2, 1, 5, 2, 0, 5, 3, 5, 4, 1, 0, 4, 5, 2, 4, 3, 5, 2, 0, 0, 1, 5, 2, 2],
             'full-ground-variable':
                    [0, 3, 0, 3, 2, 1, 2, 3, 1, 5, 6, 2, 3, 4, 4, 3, 6, 5, 2, 6, 0, 5, 4, 2, 0,
                     4, 4, 2, 3, 2, 2, 5, 0, 3, 3, 6, 6, 2, 0, 5, 0, 0, 6, 0, 6, 1, 6, 0, 1, 4,
                     4, 3, 2, 6, 5, 5, 0, 2, 5, 3, 0, 1, 4, 0, 5, 6, 4, 0, 4, 0, 3, 1, 5, 6, 4,
                     6, 3, 0, 1, 0, 0, 3, 1, 1, 5, 0, 1, 0, 5, 2, 3, 5, 4, 2, 6, 4, 1, 5, 3, 1,
                     0, 2, 0, 5, 5, 1, 0, 4, 6, 0, 4, 2, 2, 6, 4, 6, 3, 1, 1, 1, 0, 2, 4, 4, 2,
                     0, 3, 6, 6, 5, 4, 0, 2, 5, 5, 1, 3, 4, 4, 3, 0, 2, 1, 1, 1, 5, 3, 1, 6, 1,
                     6, 6, 5, 2, 4, 4, 3, 3, 5, 0, 0, 3, 0, 6, 6, 4, 1, 5, 3, 5, 5, 6, 0, 3, 4,
                     2, 1, 4, 5, 0, 0, 0, 1, 3, 2, 3, 1, 4, 2, 5, 4, 2, 3, 4, 5, 2, 6, 0, 0, 3],
             'full-space-variable':
                    [0, 3, 4, 0, 3, 2, 2, 0, 2, 6, 2, 0, 3, 5, 4, 4, 1, 0, 5, 3, 0, 4, 6, 3, 0,
                     1, 2, 5, 3, 2, 4, 2, 5, 0, 2, 2, 3, 5, 1, 5, 0, 1, 6, 4, 3, 5, 3, 6, 4, 1,
                     4, 5, 5, 6, 1, 6, 0, 2, 1, 1, 0, 4, 6, 2, 6, 5, 5, 4, 0, 3, 1, 3, 2, 2, 4,
                     0, 1, 5, 3, 4, 0, 5, 4, 6, 0, 1, 5, 3, 6, 3, 4, 0, 6, 4, 3, 4, 3, 1, 2, 2,
                     0, 3, 1, 4, 0, 1, 5, 2, 0, 6, 3, 3, 5, 3, 0, 6, 1, 5, 6, 6, 0, 5, 0, 2, 4,
                     5, 3, 6, 4, 2, 2, 2, 3, 2, 4, 0, 6, 3, 4, 1, 0, 2, 2, 4, 3, 1, 2, 1, 6, 6,
                     0, 0, 3, 5, 4, 4, 5, 2, 5, 6, 0, 1, 1, 1, 4, 6, 2, 1, 6, 6, 0, 3, 4, 2, 2,
                     5, 4, 5, 0, 3, 0, 3, 0, 6, 0, 2, 4, 5, 4, 4, 2, 2, 4, 5, 6, 6, 3, 1, 1, 0]}
y_offset = {'control-ground-variable': 
                    [0, 3, 3, 6, 0, 4, 2, 1, 5, 6, 1, 1, 3, 1, 1, 5, 5, 0, 5, 3, 0, 0, 0, 5, 3, 
                     5, 1, 3, 3, 6, 0, 4, 1, 2, 6, 2, 0, 4, 3, 1, 0, 4, 2, 3, 0, 5, 6, 5, 4, 2, 
                     4, 3, 6, 6, 6, 3, 1, 2, 2, 4, 0, 0, 6, 5, 3, 4, 3, 2, 4, 0, 0, 5, 2, 6, 4, 
                     1, 6, 1, 5, 1, 0, 6, 3, 1, 4, 2, 6, 0, 1, 5, 4, 0, 5, 3, 5, 5, 2, 6, 1, 1, 
                     0, 4, 2, 6, 4, 4, 3, 5, 5, 0, 2, 3, 0, 2, 3, 4, 2, 3, 5, 4, 0, 4, 5, 0, 4, 
                     6, 6, 1, 0, 1, 6, 3, 5, 0, 5, 3, 6, 3, 2, 1, 0, 2, 4, 2, 5, 4, 0, 5, 3, 5, 
                     3, 1, 3, 5, 4, 2, 1, 2, 4, 1, 0, 0, 3, 0, 4, 6, 5, 6, 5, 2, 5, 1, 3, 5, 6, 
                     3, 2, 1, 5, 0, 0, 2, 1, 1, 4, 4, 1, 4, 2, 5, 1, 0, 2, 5, 3, 0, 6, 0, 3, 5],
            'control-space-variable':
                    [0, 4, 1, 2, 2, 3, 0, 0, 5, 4, 1, 1, 1, 5, 4, 2, 1, 6, 1, 3, 0, 6, 3, 2, 1, 
                     5, 6, 2, 5, 6, 3, 0, 5, 5, 5, 4, 4, 2, 4, 3, 0, 0, 4, 1, 5, 2, 3, 4, 0, 5, 
                     0, 0, 2, 2, 1, 2, 1, 4, 6, 4, 0, 1, 0, 3, 1, 5, 0, 2, 5, 1, 2, 0, 2, 2, 3, 
                     4, 1, 1, 5, 6, 0, 1, 6, 5, 0, 5, 3, 5, 0, 5, 5, 3, 1, 6, 2, 6, 3, 0, 4, 1, 
                     0, 0, 5, 5, 3, 0, 2, 1, 4, 4, 5, 2, 2, 1, 6, 1, 0, 2, 5, 6, 0, 6, 1, 5, 4, 
                     3, 4, 3, 0, 0, 2, 5, 6, 5, 1, 4, 1, 5, 1, 1, 0, 2, 6, 3, 5, 0, 2, 0, 5, 2, 
                     6, 0, 6, 1, 6, 5, 2, 3, 5, 3, 0, 4, 5, 1, 0, 5, 5, 2, 2, 4, 1, 1, 6, 3, 3, 
                     1, 4, 6, 5, 1, 0, 4, 5, 0, 3, 5, 4, 3, 6, 3, 1, 3, 1, 1, 6, 2, 0, 2, 5, 2],
            'multiepoch-ground-variable':
                    [0, 3, 0, 5, 5, 1, 6, 6, 1, 6, 0, 4, 5, 2, 0, 3, 0, 5, 4, 3, 0, 1, 5, 1, 6,
                     4, 1, 2, 3, 0, 5, 1, 2, 3, 0, 2, 6, 4, 0, 6, 0, 3, 1, 6, 2, 3, 4, 4, 5, 6,
                     3, 6, 4, 4, 1, 0, 1, 3, 2, 1, 0, 4, 5, 4, 1, 5, 5, 5, 4, 3, 5, 4, 0, 2, 1,
                     0, 2, 4, 3, 3, 0, 5, 0, 5, 6, 3, 4, 3, 5, 1, 1, 1, 3, 1, 3, 4, 4, 3, 5, 2,
                     0, 2, 3, 0, 5, 1, 1, 4, 0, 3, 0, 4, 1, 2, 5, 4, 5, 5, 1, 6, 0, 3, 4, 6, 6,
                     0, 5, 0, 1, 2, 4, 1, 5, 3, 3, 2, 3, 0, 0, 2, 0, 2, 1, 5, 6, 1, 3, 5, 6, 6,
                     2, 6, 5, 6, 1, 4, 3, 3, 5, 5, 0, 6, 4, 0, 0, 3, 6, 5, 4, 2, 6, 5, 3, 6, 3,
                     3, 6, 1, 2, 1, 0, 3, 2, 6, 1, 6, 4, 2, 5, 4, 4, 0, 0, 0, 6, 4, 4, 6, 3, 6],
            'multiepoch-space-variable':
                    [0, 6, 1, 5, 6, 4, 2, 0, 3, 2, 0, 4, 2, 6, 3, 1, 6, 5, 4, 5, 0, 3, 1, 4, 6,
                     3, 6, 5, 6, 5, 4, 4, 4, 0, 5, 1, 1, 3, 5, 1, 0, 5, 2, 6, 3, 4, 6, 6, 2, 1,
                     5, 0, 5, 5, 1, 3, 3, 2, 1, 4, 0, 1, 2, 2, 0, 5, 5, 2, 0, 3, 4, 4, 5, 6, 5,
                     1, 3, 3, 6, 4, 0, 0, 0, 3, 5, 2, 0, 4, 5, 4, 3, 3, 1, 5, 2, 3, 3, 1, 1, 2,
                     0, 4, 2, 3, 2, 1, 6, 0, 2, 0, 6, 6, 0, 1, 5, 1, 6, 3, 5, 5, 0, 3, 1, 3, 5,
                     1, 2, 4, 1, 0, 6, 2, 0, 0, 4, 6, 5, 4, 6, 4, 0, 3, 0, 0, 4, 1, 6, 4, 5, 4,
                     6, 1, 3, 0, 1, 4, 1, 5, 0, 3, 0, 1, 1, 2, 0, 6, 6, 6, 0, 5, 0, 3, 2, 5, 4,
                     3, 3, 1, 2, 1, 0, 4, 1, 5, 3, 6, 5, 6, 2, 2, 4, 3, 5, 4, 2, 3, 2, 3, 1, 5],
            'variable_psf-ground-variable':
                    [0, 4, 0, 5, 1, 4, 6, 3, 0, 2, 2, 6, 5, 5, 3, 3, 6, 3, 6, 0, 0, 2, 6, 3, 3,
                     2, 5, 5, 0, 6, 1, 4, 3, 4, 2, 2, 1, 5, 0, 1, 0, 4, 6, 1, 5, 5, 6, 6, 5, 0,
                     0, 5, 2, 1, 0, 3, 0, 2, 5, 1, 0, 1, 2, 6, 6, 6, 3, 0, 4, 0, 2, 0, 2, 2, 1,
                     0, 2, 3, 5, 2, 0, 0, 6, 1, 4, 2, 1, 1, 1, 2, 6, 4, 3, 4, 2, 2, 6, 5, 6, 2,
                     0, 5, 4, 0, 3, 6, 6, 3, 5, 4, 2, 3, 3, 1, 1, 0, 1, 1, 3, 2, 0, 6, 6, 3, 2,
                     4, 5, 1, 4, 3, 3, 6, 0, 1, 0, 4, 1, 2, 2, 0, 0, 0, 2, 3, 2, 3, 0, 5, 1, 5,
                     3, 2, 5, 4, 4, 5, 5, 2, 3, 4, 0, 0, 4, 2, 6, 2, 6, 0, 6, 2, 3, 1, 4, 5, 1,
                     5, 5, 1, 3, 0, 0, 2, 5, 1, 1, 4, 6, 6, 1, 6, 0, 0, 6, 1, 2, 5, 6, 5, 2, 4],
            'variable_psf-space-variable':
                    [0, 2, 3, 2, 1, 0, 5, 6, 3, 1, 5, 4, 2, 1, 1, 0, 6, 2, 6, 1, 0, 3, 3, 0, 1,
                     4, 0, 0, 1, 6, 5, 3, 3, 1, 6, 1, 6, 3, 2, 5, 0, 6, 1, 2, 3, 6, 2, 6, 5, 5,
                     0, 5, 0, 1, 4, 5, 0, 1, 0, 3, 0, 4, 5, 2, 2, 5, 1, 4, 0, 3, 6, 2, 1, 0, 2,
                     6, 5, 0, 1, 1, 0, 1, 6, 6, 5, 3, 0, 5, 1, 2, 4, 5, 3, 5, 2, 4, 3, 2, 0, 1,
                     0, 6, 5, 1, 6, 4, 1, 1, 2, 2, 2, 3, 3, 5, 3, 0, 5, 6, 5, 0, 0, 5, 5, 3, 6,
                     4, 2, 4, 2, 3, 2, 6, 2, 5, 6, 1, 5, 0, 5, 0, 0, 2, 0, 0, 1, 5, 2, 3, 4, 4,
                     6, 2, 0, 2, 2, 6, 1, 1, 5, 2, 0, 1, 1, 3, 5, 0, 4, 3, 0, 2, 4, 6, 3, 5, 1,
                     5, 3, 0, 1, 6, 0, 5, 2, 3, 5, 1, 0, 2, 4, 3, 1, 6, 4, 5, 3, 2, 0, 5, 3, 0],
            'real_galaxy-ground-variable':
                    [0, 3, 0, 1, 5, 1, 0, 0, 4, 6, 2, 4, 6, 1, 4, 4, 6, 3, 1, 2, 0, 1, 0, 4, 3, 
                     0, 6, 6, 5, 0, 2, 4, 6, 5, 0, 5, 1, 0, 6, 1, 0, 3, 3, 3, 2, 5, 2, 0, 4, 3, 
                     4, 2, 6, 3, 5, 4, 1, 6, 0, 6, 0, 4, 3, 6, 5, 3, 6, 2, 0, 2, 4, 1, 3, 0, 5, 
                     4, 0, 3, 2, 5, 0, 3, 0, 1, 1, 2, 2, 1, 1, 5, 4, 4, 3, 6, 6, 1, 3, 6, 0, 1, 
                     0, 3, 4, 4, 5, 6, 3, 5, 2, 2, 6, 0, 3, 2, 6, 0, 1, 0, 0, 4, 0, 6, 4, 5, 3, 
                     5, 6, 1, 0, 6, 5, 6, 5, 2, 6, 2, 4, 1, 4, 3, 0, 0, 5, 2, 0, 5, 6, 2, 3, 4, 
                     1, 2, 5, 6, 5, 6, 2, 3, 5, 3, 0, 3, 0, 0, 6, 4, 5, 6, 5, 2, 3, 1, 1, 6, 2,
                     1, 4, 0, 3, 4, 0, 3, 2, 4, 5, 6, 6, 0, 4, 1, 4, 5, 1, 5, 2, 2, 6, 2, 6, 1],
            'real_galaxy-space-variable': 
                    [0, 6, 5, 3, 2, 4, 1, 4, 6, 2, 3, 5, 0, 1, 0, 0, 1, 2, 1, 3, 0, 1, 6, 6, 3, 
                     6, 0, 1, 6, 5, 5, 6, 0, 4, 4, 1, 1, 4, 1, 5, 0, 1, 5, 2, 3, 4, 0, 0, 1, 3, 
                     2, 3, 2, 4, 0, 4, 4, 6, 6, 4, 0, 3, 3, 4, 4, 0, 2, 6, 0, 1, 6, 6, 1, 0, 1, 
                     3, 4, 6, 5, 3, 0, 2, 6, 6, 4, 2, 5, 5, 2, 4, 0, 1, 4, 1, 5, 6, 1, 4, 4, 6, 
                     0, 6, 3, 2, 5, 3, 2, 4, 3, 1, 5, 6, 1, 4, 3, 2, 3, 2, 5, 2, 0, 1, 3, 1, 4, 
                     6, 1, 4, 3, 3, 1, 5, 0, 4, 5, 2, 4, 1, 2, 6, 0, 6, 5, 0, 0, 4, 3, 2, 2, 6, 
                     3, 0, 2, 2, 2, 2, 0, 1, 0, 2, 0, 5, 3, 6, 4, 4, 2, 5, 5, 6, 4, 0, 4, 5, 2, 
                     1, 3, 4, 0, 2, 0, 6, 2, 0, 5, 2, 1, 3, 4, 5, 6, 0, 3, 0, 4, 2, 6, 1, 2, 3],
             'full-ground-variable':
                    [0, 4, 2, 0, 6, 6, 5, 2, 0, 1, 2, 2, 3, 6, 0, 5, 0, 0, 0, 4, 0, 2, 5, 0, 5,
                     4, 3, 3, 5, 4, 5, 0, 6, 2, 3, 6, 4, 1, 2, 1, 0, 5, 1, 3, 6, 5, 4, 6, 6, 0,
                     4, 5, 1, 2, 2, 6, 4, 3, 0, 6, 0, 0, 1, 4, 2, 2, 4, 5, 3, 1, 1, 6, 4, 0, 5,
                     6, 2, 2, 3, 3, 0, 5, 2, 0, 3, 4, 1, 3, 0, 2, 2, 4, 6, 5, 3, 0, 3, 5, 6, 5,
                     0, 6, 4, 1, 6, 0, 1, 0, 3, 3, 1, 3, 0, 0, 6, 6, 4, 5, 1, 6, 0, 6, 0, 4, 2,
                     6, 0, 1, 2, 6, 2, 3, 0, 2, 3, 0, 6, 5, 1, 1, 0, 0, 6, 3, 4, 5, 0, 0, 3, 5,
                     2, 4, 4, 4, 6, 0, 4, 1, 6, 5, 0, 6, 4, 5, 0, 0, 5, 4, 3, 6, 2, 1, 6, 5, 5,
                     1, 0, 2, 5, 3, 0, 6, 2, 5, 1, 3, 6, 6, 2, 4, 2, 6, 1, 4, 2, 0, 4, 4, 3, 0],
             'full-space-variable':
                    [0, 3, 2, 2, 2, 0, 5, 4, 2, 2, 1, 3, 4, 5, 4, 0, 1, 5, 3, 6, 0, 3, 0, 3, 5,
                     1, 3, 6, 2, 2, 5, 0, 1, 3, 5, 1, 0, 2, 2, 3, 0, 4, 6, 6, 1, 3, 2, 1, 5, 5,
                     2, 2, 6, 3, 1, 5, 2, 4, 2, 6, 0, 2, 0, 6, 2, 3, 2, 5, 1, 5, 4, 0, 0, 4, 4,
                     4, 2, 6, 2, 3, 0, 0, 0, 4, 2, 2, 5, 1, 5, 4, 2, 6, 6, 1, 5, 4, 2, 1, 6, 5,
                     0, 1, 0, 5, 1, 5, 1, 0, 2, 2, 4, 0, 6, 2, 3, 5, 4, 2, 0, 3, 0, 3, 6, 6, 0,
                     0, 2, 5, 3, 0, 2, 4, 4, 5, 2, 3, 6, 3, 1, 1, 0, 5, 2, 5, 4, 0, 3, 2, 2, 1,
                     1, 4, 6, 4, 3, 0, 1, 4, 5, 5, 0, 0, 5, 1, 1, 0, 1, 3, 3, 2, 2, 4, 4, 0, 4,
                     1, 5, 6, 3, 6, 0, 2, 4, 0, 2, 1, 5, 0, 3, 2, 6, 5, 6, 3, 4, 6, 3, 1, 2, 1]}
def expected_galaxy_ids(branch):
    """
    Builds a list of galaxy IDs to compare user catalogs against, using known offsets if a 
    variable-shear branch.
    """
    if 'constant' in branch:
        expected_galaxy_id = ['%09i'%(1000000*k+1000*j+i) for i in range(100) 
                                                          for j in range(100) 
                                                          for k in range(200)]
    else:
        expected_galaxy_id = ['%09i'%(1000000*k+1000*(7*j+x_offset[branch][k])
                                      +7*i+y_offset[branch][k])
                                             for i in range(100) for j in range(100) 
                                             for k in range(200)]                                                           
    return expected_galaxy_id
    
